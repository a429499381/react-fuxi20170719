<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <title>LeanClound</title>
</head>
<body>
<div id="welcome"></div>
<form name="signIn">
  <input type="text" name="username" placeholder="用户名">
  <input type="password" name="password" placeholder="密码">
  <input type="email" name="emial" placeholder="邮箱">
  <input type="submit" value="注册">
</form>

<form name="signUp">
  <input type="text" name="username" placeholder="用户名">
  <input type="password" name="password" placeholder="密码">
  <input type="submit" value="登陆">
</form>

<button id="LogOut">登出</button>



<script src="//cdn1.lncld.net/static/js/3.2.1/av-min.js"></script>
<script>
  // 初始化
  var APP_ID = '3X9jTyLPjORGtQIdFneYartA-gzGzoHsz';
  var APP_KEY = '9XKG8fPj4NlLgIWf71AWrQeD';

  AV.init({
    appId: APP_ID,
    appKey: APP_KEY
  });

  var user = AV.User.current()
  if(user) {
    welcome.textContent = '你好' + user.attributes.username
    console.log(AV.User.current().attributes)

  }

//  // 要保存的 表名
//  var Testobject = AV.Object.extend('object')
//  // 建立一个表的 实例
//  var textobject = new Testobject()
//  // 保存数据
//  textobject.save({
//    name: 'xutao'
//  }).then(res => {
//    consoel.log('保存OK')
//  })
// 注册
var singInForm = document.querySelector('form[name=signIn]')
singInForm.addEventListener('submit', function (e) {
  e.preventDefault()

  // 新建一个 实例
  var user= new AV.User();

  user.setUsername(singInForm.username.value)
  user.setPassword(singInForm.password.value)
  user.setEmail(singInForm.emial.value)

  user.signUp().then(function (loginedUser) {
    console.log('注册成功')
    // 刷新网页
    location.reload()
  }), function (err) {
    console.log(err)
  }
})

// 登陆模块
var singUpForm = document.querySelector('form[name=signUp]')
  singUpForm.addEventListener('submit', function (e) {
  e.preventDefault()

  var username =   singUpForm.username.value
  var password =   singUpForm.password.value
  // 登陆方法
  AV.User.logIn(username, password).then(function (loginedUser) {
    alert(loginedUser);
    location.reload()
  }, function (error) {
    alert(err)
  });
})

// 登出
  LogOut.onclick = function () {
    AV.User.logOut()
    alert('登出陈功')
    location.reload()
  }


</script>
</body>
</html>